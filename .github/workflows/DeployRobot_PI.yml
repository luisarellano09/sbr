name: Deploy Robot - PI

on:
  workflow_dispatch:
  
jobs: 
  deploy:
    runs-on: [self-hosted, sbr-pi]
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Docker Compose
        working-directory: ./SBR_PI/DevOps
        run: docker compose up --build -d
      - name: Restart NGINX
        working-directory: ./SBR_PI/DevOps
        run: docker compose restart sbr_nginx
      - name: Delete old images
        run: docker image prune -f
      - name: Install Services
        uses: ./.github/workflows/InstallServices_PI.yml
        with:
          workflow-to-trigger: "Deploy Robot - PI"